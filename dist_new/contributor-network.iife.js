var ContributorNetwork=function(ke){"use strict";const ae={grenadier:"#CF3F02",aquamarine:"#2E86AB",aquamarineLight:"#3A9BBF",background:"#f7f7f7",contributor:"#3A9BBF",repo:"#2E86AB",repoMain:"#CF3F02",owner:"#CF3F02",link:"#e8e8e8",text:"#443F3F",accent:"#CF3F02",highlightFill:"#CF3F0230",shadow:"#f7f7f7",shadowDark:"#d4d4d4"},bt={family:"Roboto",familyCondensed:"Roboto Condensed",familyMono:"Fira Code",normal:400,bold:700,baseSizeContributor:11,baseSizeRepo:10,baseSizeOwner:12},Z={defaultCanvas:1500,contributorRadius:{min:8,max:30},remainingContributorRadius:{min:1,max:8},repoRadius:{min:4,max:20},linkWidth:{min:1,mid:2,max:60},linkDistance:{min:10,max:80}},Se={centralRadius:100,innerRadiusFactor:1.5,contributorPadding:20,linkDistanceDomain:[1,50],linkWidthExponent:.75,bboxPadding:2};function X(e){return typeof e=="object"&&e!==null?e.id:e}function Be(e,r,a={}){const{removeUnresolved:l=!0,onUnresolved:c=null}=a,n=new Map(r.map(s=>[s.id,s])),g=[];for(const s of e){let i=s.source,u=s.target;typeof i=="string"&&(i=n.get(i),!i&&c&&c("source",s.source)),typeof u=="string"&&(u=n.get(u),!u&&c&&c("target",s.target)),i&&u&&i.id&&u.id?g.push({...s,source:i,target:u}):l||g.push({...s,source:i||null,target:u||null})}return g}function wt(e){return e.scaleSqrt().range([Z.repoRadius.min,Z.repoRadius.max])}function vt(e){return e.scaleSqrt().range([Z.contributorRadius.min,Z.contributorRadius.max])}function Rt(e){return e.scaleSqrt().range([Z.remainingContributorRadius.min,Z.remainingContributorRadius.max])}function At(e){return e.scaleLinear().domain(Se.linkDistanceDomain).range([Z.linkDistance.min,Z.linkDistance.max])}function Ct(e){return e.scalePow().exponent(Se.linkWidthExponent).range([Z.linkWidth.min,Z.linkWidth.mid,Z.linkWidth.max])}const Ot=Math.PI,Te=Math.min,kt=bt.family;function $(e,r,a,l="normal",c=kt){e.font=`${a} ${l} ${r}px ${c}`}function Fe(e,r=1,a=12){$(e,a*r,400,"normal")}function Ue(e,r=1,a=15){$(e,a*r,700,"normal")}function Ge(e,r=1,a=12){$(e,a*r,700,"normal")}function Xe(e,r=1,a=13){$(e,a*r,700,"italic")}function z(e,r,a,l,c=0,n=!1){const g=String.prototype.split.call(r,"");let s=0,i,u=a;const h=e.textAlign;let k=0;for(let I=0;I<g.length;I++)k+=e.measureText(g[I]).width+c;h==="right"?u=a-k:h==="center"&&(u=a-k/2),e.textAlign="left";const d=u;for(;s<r.length;)i=g[s++],n&&e.strokeText(i,u,l),e.fillText(i,u,l),u+=e.measureText(i).width+c;const p=u-e.measureText(i).width/2;return e.textAlign=h,[d,p]}function Tt(e,r,a,l=!0){const c=r.split(" ");let n=[],g=c[0];for(let i=1;i<c.length;i++){const u=c[i];e.measureText(g+" "+u).width<a?g+=" "+u:(n.push(g),g=u)}n.push(g),l&&n.length===2&&(n=Et(r));let s=0;return n.forEach(i=>{const u=e.measureText(i).width;u>s&&(s=u)}),[n,s]}function Et(e){const r=e.length,a=[];for(let i=0;i<e.length;i++)e[i]===" "&&a.push(i);const l=a.map(i=>Math.abs(r/2-i)),c=Te(...l),n=a[l.indexOf(c)],g=e.substr(0,n),s=e.substr(n);return[g.trim(),s.trim()]}function Je(e,r,a,l,c,n=0){let g=c==="up"?a:a-Ot,s=r;c==="up"&&(s=s.split("").reverse().join(""));for(let i=0;i<s.length;i++){const u=e.measureText(s[i]).width;g+=(u+(i===s.length-1?0:n))/l/2}e.save(),e.rotate(g);for(let i=0;i<s.length;i++){const u=e.measureText(s[i]).width/2,h=(c==="up"?-1:1)*l;e.rotate(-(u+n)/l),z(e,s[i],0,h,0),e.rotate(-(u+n)/l)}e.restore()}const ce={lineHeight:1.4,sectionSpacing:20,labelFontSize:11,valueFontSize:11.5,headerFontSize:12,labelOpacity:.6,valueOpacity:.9,warningOpacity:.7};function Ee(e,r){return e<10?String(e):r(e)}function Ye(e){const r=Math.round(e*100);return r>=70?"Strong":r>=40?"Moderate":"Growing"}function It(e,r,a,l,c,n){$(e,ce.headerFontSize*c,400,"normal"),e.globalAlpha=1;const s=Ee(r.stars,n),i=Ee(r.forks,n),u=Ee(r.watchers||0,n);return z(e,`${s} stars | ${i} forks | ${u} watchers`,a*c,l*c,1.25*c),l}function Nt(e,r,a,l,c){const n=ce;if(!r.languages||r.languages.length===0)return l;l+=n.sectionSpacing,e.globalAlpha=n.labelOpacity,$(e,n.labelFontSize*c,400,"italic"),z(e,"Languages",a*c,l*c,2*c),l+=n.valueFontSize*n.lineHeight+4,e.globalAlpha=n.valueOpacity,$(e,n.valueFontSize*c,400,"normal");let g="";const s=Te(3,r.languages.length);for(let i=0;i<s;i++)g+=`${r.languages[i]}${i<s-1?", ":""}`;return z(e,g,a*c,l*c,1.25*c),r.languages.length>3&&(l+=n.valueFontSize*n.lineHeight,z(e,`& ${r.languages.length-3} more`,a*c,l*c,1.25*c)),l+=n.valueFontSize*n.lineHeight,l}function $t(e,r,a,l,c){const n=ce;if(!r.totalContributors||r.totalContributors===0)return l;l+=n.sectionSpacing,e.globalAlpha=n.labelOpacity,$(e,n.labelFontSize*c,400,"italic"),z(e,"Community",a*c,l*c,2*c),l+=n.valueFontSize*n.lineHeight+4,e.globalAlpha=n.valueOpacity,$(e,n.valueFontSize*c,400,"normal");const g=r.totalContributors,s=r.devseedContributors||0,i=r.externalContributors||0;z(e,`${g} contributors (${s} DevSeed, ${i} community)`,a*c,l*c,1.25*c),l+=n.valueFontSize*n.lineHeight;const u=r.communityRatio||0,h=Math.round(u*100),k=Ye(u);return z(e,`Community Health: ${h}% (${k})`,a*c,l*c,1.25*c),s===1&&g>0&&(l+=n.valueFontSize*n.lineHeight,e.globalAlpha=n.warningOpacity,$(e,n.valueFontSize*c,400,"italic"),z(e,"âš  Single DevSeed maintainer",a*c,l*c,1.25*c),e.globalAlpha=n.valueOpacity,$(e,n.valueFontSize*c,400,"normal")),l+=n.valueFontSize*n.lineHeight,l}function Lt(e,r,a,l,c){const n=ce;return r.license&&(l+=n.sectionSpacing,e.globalAlpha=n.valueOpacity,$(e,n.valueFontSize*c,400,"normal"),z(e,`License: ${r.license}`,a*c,l*c,1.25*c),l+=n.valueFontSize*n.lineHeight),l}function xt(e,r,a,l,c){const n=ce;return r.archived&&(l+=n.sectionSpacing,e.globalAlpha=n.warningOpacity,$(e,n.valueFontSize*c,400,"italic"),z(e,"ðŸ“¦ Archived",a*c,l*c,1.25*c),e.globalAlpha=n.valueOpacity,l+=n.valueFontSize*n.lineHeight),l}function je(e,r,a,l,c,n,g){e.filter(s=>s.type==="owner").forEach((s,i)=>{s.x=s.fx=0,s.y=s.fy=0}),e.filter(s=>s.type==="owner").forEach(s=>{let i=e.filter(p=>r.find(I=>l(I.source)===s.id&&l(I.target)===p.id&&p.degree===1)||p.id===s.id);s.connected_node_cloud=i.filter(p=>p.type==="repo");let u=r.filter(p=>l(p.source)===s.id&&i.find(I=>I.id===l(p.target)));i.forEach(p=>{p.x=s.fx+Math.random()*(Math.random()>.5?1:-1),p.y=s.fy+Math.random()*(Math.random()>.5?1:-1)});let h=a.forceSimulation().force("link",a.forceLink().id(p=>p.id).strength(0)).force("collide",a.forceCollide().radius(p=>{let I;return p.id===s.id?s.data.single_contributor?I=s.r+2:I=s.r+g(14,n(10,s.r)):I=p.r+n(2,p.r*.2),I}).strength(0)).force("x",a.forceX().x(s.fx).strength(.1)).force("y",a.forceY().y(s.fy).strength(.1));h.nodes(i).stop(),h.force("link").links(u);let k=200;for(let p=0;p<k;++p)h.tick(),h.force("collide").strength(Math.pow(p/k,2)*.8);s.max_radius=a.max(i,p=>c((p.x-s.x)**2+(p.y-s.y)**2));let d=i.find(p=>c((p.x-s.x)**2+(p.y-s.y)**2)===s.max_radius);s.max_radius=n(s.max_radius+d.r,s.r),delete s.fx,delete s.fy})}function qe(e,r,a,l,c,n){e.filter(g=>g.type==="contributor").forEach((g,s)=>{g.x=g.fx=0,g.y=g.fy=0}),e.filter(g=>g.type==="contributor").forEach(g=>{let s=e.filter(d=>r.find(p=>l(p.source)===g.id&&l(p.target)===d.id&&d.degree===1)||r.find(p=>l(p.source)===g.id&&l(p.target)===d.id&&d.type==="owner"&&d.data.single_contributor===!0)||d.id===g.id);if(g.connected_single_repo=s.filter(d=>d.type==="repo"||d.type==="owner"),typeof localStorage<"u"&&localStorage.getItem("debug-orca")==="true"&&(console.log(`Contributor ${g.id}: connected repos = ${g.connected_single_repo.length}`),g.connected_single_repo.length===0)){const d=r.filter(p=>l(p.source)===g.id);if(console.log(`  - Actual links from contributor: ${d.length}`),d.length>0){const p=l(d[0].target),I=e.find(C=>C.id===p);console.log(`  - First target: ${p}, degree: ${I?I.degree:"?"}`)}}let i=[];g.connected_single_repo.forEach(d=>{i.push({source:g.id,target:d.id})}),s.forEach(d=>{d.x=g.fx+Math.random()*(Math.random()>.5?1:-1),d.y=g.fy+Math.random()*(Math.random()>.5?1:-1)});let u=a.forceSimulation().nodes(s).force("link",a.forceLink().id(d=>d.id).strength(0)).force("charge",a.forceManyBody().strength(-10)).force("collide",a.forceCollide(d=>d.r+2).strength(.1)).force("x",a.forceX().x(g.fx).strength(.1)).force("y",a.forceY().y(g.fy).strength(.1));u.nodes(s).stop(),u.force("link").links(i);let h=200;for(let d=0;d<h;++d)u.tick(),u.force("collide").strength(Math.pow(d/h,2)*.8);g.max_radius=a.max(s,d=>c((d.x-g.x)**2+(d.y-g.y)**2));let k=s.find(d=>c((d.x-g.x)**2+(d.y-g.y)**2)===g.max_radius);g.max_radius=n(g.max_radius+(k?k.r:0),g.r),typeof localStorage<"u"&&localStorage.getItem("debug-orca")==="true"&&console.log(`Contributor ${g.id}: max_radius = ${g.max_radius}`)})}function Ve(e,r,a,l,c,n,g,s,i,u,h,k){let d,p=a.forceSimulation().force("link",a.forceLink().id(m=>m.id).distance(m=>u(m.target.degree)*5)).force("collide",a.bboxCollide(m=>m.bbox).strength(0).iterations(1)).force("charge",a.forceManyBody());d=e.filter(m=>m.type==="contributor"||m.type==="owner"&&m.data.single_contributor==!1||m.id===s||m.type==="repo"&&m.data.multi_repo_owner===!1&&m.degree>1),d.forEach(m=>{m.node_central=!0}),d.forEach(m=>{if(m.type==="contributor"){m.bbox=[[-m.max_radius,-m.max_radius],[m.max_radius,m.max_radius]];return}m.id===i.id?Ue(g,1):m.type==="owner"?Ge(g,1):m.type==="repo"&&Fe(g,1);let v=g.measureText(m.label);if(m.type==="repo"&&g.measureText(m.data.owner).width>v.width&&(v=g.measureText(m.data.owner)),m.id===s){let j=m.r+14,x=n(j*2,v.width*1.25)+10;m.bbox=[[-x/2,-j],[x/2,j]];return}let M=v.fontBoundingBoxAscent+v.fontBoundingBoxDescent;m.type==="repo"&&(M*=2);let P=m.type==="owner"?m.max_radius:m.r,D=n(P,m.r+M),T=n(P*2,v.width*1.25)+10;m.bbox=[[-T/2,-D],[T/2,P]]});let I=r.filter(m=>d.find(v=>v.id===l(m.source))&&d.find(v=>v.id===l(m.target)));p.nodes(d).stop(),p.force("link").links(I);let C=300;for(let m=0;m<C;++m)p.tick(),N(d,c,n,h,k),p.force("collide").strength(Math.pow(m/C,2)*.7);d.forEach(m=>{m.fx=m.x,m.fy=m.y}),e.filter(m=>m.type==="owner").forEach(m=>{m.connected_node_cloud&&m.connected_node_cloud.length>0&&m.connected_node_cloud.forEach(v=>{v.x=m.x+v.x,v.y=m.y+v.y})});function N(m,v,M,P,D){m.forEach(T=>{if(T.type==="repo"||T.type==="owner"){const j=v(T.x**2+T.y**2);j>P*D&&(T.x=T.x/j*P*D,T.y=T.y/j*P*D)}})}return d}function Ke(e,r,a,l,c,n,g,s,i,u,h){let k=(g*2.3/2-g)*2,d=s+k*2;e.forEach(C=>{let N=Math.random()*a;C.x=(d+Math.random()*50)*l(N),C.y=(d+Math.random()*50)*c(N),C.r=h(C.commit_count)});let p=r.forceSimulation().force("collide",r.forceCollide().radius(C=>C.r+Math.random()*20+10).strength(1)).force("x",r.forceX().x(0).strength(.01)).force("y",r.forceY().y(0).strength(.01));e.push({x:0,y:0,fx:0,fy:0,r:s+k*.75,id:"dummy"}),p.nodes(e).stop();let I=30;for(let C=0;C<I;++C)p.tick();e.pop()}function Ht(){return{organizations:[]}}function Mt(e,r){return e.organizations.includes(r)||e.organizations.push(r),e}function zt(e,r){return e.organizations=e.organizations.filter(a=>a!==r),e}function Pt(e,r){return e.organizations.includes(r)}function Wt(e){return e.organizations.length>0}function Dt(){return{hoverActive:!1,hoveredNode:null,clickActive:!1,clickedNode:null,delaunay:null,nodesDelaunay:null,delaunayRemaining:null}}function St(e,r){return e.hoverActive=!!r,e.hoveredNode=r,e}function Ze(e){return e.hoverActive=!1,e.hoveredNode=null,e}function Bt(e,r){return e.clickActive=!!r,e.clickedNode=r,e}function Ft(e){return e.clickActive=!1,e.clickedNode=null,e}function Ut(e){return e.hoverActive=!1,e.hoveredNode=null,e.clickActive=!1,e.clickedNode=null,e}function Qe(e,r,a,l=null){return e.delaunay=r,e.nodesDelaunay=a,e.delaunayRemaining=l,e}function Gt(e){return e.delaunay=null,e.nodesDelaunay=null,e.delaunayRemaining=null,e}function et(e,r,a,l,c,n,g){const{PIXEL_RATIO:s,WIDTH:i,HEIGHT:u,SF:h,RADIUS_CONTRIBUTOR_NON_ORCA:k,ORCA_RING_WIDTH:d,sqrt:p}=a,{delaunay:I,nodesDelaunay:C,delaunayRemaining:N}=l;e=(e*s-i/2)/h,r=(r*s-u/2)/h;const m=k+d+200;if(p(e*e+r*r)>m)return[null,!1];let M=I.find(e,r),P=C[M];if(!P)return[null,!1];let D=p((P.x-e)**2+(P.y-r)**2),T=D<P.r+(c.clickActive?10:50);return!T&&n&&N&&(M=N.find(e,r),P=g[M],P&&(D=p((P.x-e)**2+(P.y-r)**2),T=D<P.r+5)),[P,T]}function Xt(e,r,a,l,c,n,g,s,i,u,h,k,d){const{WIDTH:p,HEIGHT:I}=a;e.select(r).on("mousemove",function(C){try{let[N,m]=e.pointer(C,this),[v,M]=et(N,m,a,l,c,i,u);M&&v&&v.id!==n?(h(c,v),v.remaining_contributor||(g.style.opacity=v.type==="contributor"?"0.15":"0.3"),d(s,v)):(s.clearRect(0,0,p,I),k(c),c.clickActive||(g.style.opacity="1"))}catch(N){console.warn("Hover error:",N),s.clearRect(0,0,p,I),k(c),c.clickActive||(g.style.opacity="1")}}),e.select(r).on("mouseleave",function(){s.clearRect(0,0,p,I),k(c),c.clickActive||(g.style.opacity="1")})}function Jt(e,r,a,l,c,n,g,s,i,u,h,k,d,p,I,C,N){const{WIDTH:m,HEIGHT:v}=a;e.select(r).on("click",function(M){let[P,D]=e.pointer(M,this),[T,j]=et(P,D,a,l,c,h,k);s.clearRect(0,0,m,v),j&&T&&T.id!==n?(d(c,T),l.nodesDelaunay=T.neighbors?[...T.neighbors,T]:u,l.delaunay=e.Delaunay.from(l.nodesDelaunay.map(x=>[x.x,x.y])),C(c,l.delaunay,l.nodesDelaunay,l.delaunayRemaining),N(s,T,!1),i.clearRect(0,0,m,v)):(p(c),I(c),l.nodesDelaunay=u,l.delaunay=e.Delaunay.from(l.nodesDelaunay.map(x=>[x.x,x.y])),C(c,l.delaunay,l.nodesDelaunay,l.delaunayRemaining),g.style.opacity="1")})}function Ae(e,r,a,l,c=10,n=!0,g=!1){const s=Math.PI*2;n===!0&&e.beginPath(),e.moveTo((r+c)*l,a*l),e.arc(r*l,a*l,c*l,0,s),n&&g==!1&&e.fill()}function Yt(e,r,a){if(!a.center){e.lineTo(a.target.x*r,a.target.y*r);return}let l=a.center,c=Math.atan2(a.source.y*r-l.y*r,a.source.x*r-l.x*r),n=Math.atan2(a.target.y*r-l.y*r,a.target.x*r-l.x*r);e.arc(l.x*r,l.y*r,a.r*r,c,n,a.sign)}function jt(e,r,a){e.beginPath(),e.moveTo(a.source.x*r,a.source.y*r),a.center?Yt(e,r,a):e.lineTo(a.target.x*r,a.target.y*r),e.stroke()}function qt(e,r,a,l,c){const{REPO_CENTRAL:n,COLOR_BACKGROUND:g,max:s}=l;let i=a.type==="repo"&&!a.data.orca_impacted;const u=a.id===n;u&&(i=!1),e.shadowBlur=c.hoverActive?0:s(2,a.r*.2)*r,e.shadowColor="#f7f7f7",e.globalAlpha=u?.5:i?.4:1,e.fillStyle=a.color,Ae(e,a.x,a.y,r,a.r),e.globalAlpha=1,e.shadowBlur=0,i&&Ae(e,a.x,a.y,r,a.r*.3),a.remaining_contributor||(e.strokeStyle=g,e.lineWidth=s(c.hoverActive?1.5:1,a.r*.07)*r,Ae(e,a.x,a.y,r,a.r,!0,!0),e.stroke())}function Vt(e,r,a,l,c,n,g){if(l.hoverActive&&l.hoveredNode&&l.hoveredNode.type==="contributor"&&a.type==="repo"){let s=l.hoveredNode.data.links_original.find(i=>i.repo===a.id);s&&Zt(e,r,a,a,s,c,n,g)}}function Kt(e,r,a,l){const c=Math.PI*2;let n=r.r+(r.type==="contributor"?9:r===l?14:7);e.beginPath(),e.moveTo((r.x+n)*a,r.y*a),e.arc(r.x*a,r.y*a,n*a,0,c),e.strokeStyle=r.color,e.lineWidth=3*a,e.stroke()}function Zt(e,r,a,l,c,n,g,s){const i=Math.PI*2;e.save(),e.translate(a.x*r,a.y*r),e.fillStyle=n,e.strokeStyle=n;const u=g.scaleLinear().domain([l.data.createdAt,l.data.updatedAt]).range([0,i]);let h=a.r+(a.type==="contributor"||a===s?2.5:1),k=h+3;const d=g.arc().innerRadius(h*r).outerRadius(k*r).startAngle(u(c.commit_sec_min)).endAngle(u(c.commit_sec_max)).context(e);e.beginPath(),d(),e.fill(),e.restore()}function Qt(e,r,a,l,c,n,g,s){const{COLOR_LINK:i}=l;if(!a.source||!a.target||typeof a.source.x!="number"||typeof a.target.x!="number"||!isFinite(a.source.x)||!isFinite(a.source.y)||!isFinite(a.target.x)||!isFinite(a.target.y))return;a.source.x!==void 0&&a.target.x!==void 0?(n(e,a),g(a,1),e.strokeStyle=a.gradient||i):e.strokeStyle=i;let u=s(a.commit_count);if(c.hoverActive&&c.hoveredNode&&c.hoveredNode.type==="contributor"&&c.hoveredNode.data&&c.hoveredNode.data.links_original&&a.source.type==="owner"&&a.target.type==="repo"){let h=c.hoveredNode.data.links_original.find(k=>k.repo===a.target.id);h&&(u=s(h.commit_count))}e.lineWidth=u*r,jt(e,r,a)}function er(e,r,a,l,c,n,g){var h;const s=ce,i=1.2;let u=0;return u+=18,u+=12*i,u+=18,u+=15*i,u+=15*i,u+=24,u+=11*i,u+=11*i,u+=20,u+=s.headerFontSize*i,e.data.languages&&e.data.languages.length>0&&(u+=s.sectionSpacing,u+=s.labelFontSize*s.lineHeight+4,u+=s.valueFontSize*s.lineHeight,e.data.languages.length>3&&(u+=s.valueFontSize*s.lineHeight)),e.data.totalContributors&&e.data.totalContributors>0&&(u+=s.sectionSpacing,u+=s.labelFontSize*s.lineHeight+4,u+=s.valueFontSize*s.lineHeight,u+=s.valueFontSize*s.lineHeight,e.data.devseedContributors===1&&e.data.totalContributors>0&&(u+=s.valueFontSize*s.lineHeight)),e.data.license&&(u+=s.sectionSpacing,u+=s.valueFontSize*s.lineHeight),e.data.archived&&(u+=s.sectionSpacing,u+=s.valueFontSize*s.lineHeight),r.clickActive&&r.clickedNode&&r.clickedNode.type==="contributor"&&((h=r.clickedNode.data.links_original)!=null&&h.find(d=>d.repo===e.id))&&(u+=28,u+=11*i,u+=16,u+=11.5*i,u+=18,u+=11*i),u+=18,u+=12,Math.ceil(u)}function tr(e,r,a,l,c,n,g,s){var I;const i=ce;let u=0;$(e,14*c,700,"normal");let h=e.measureText(r.data.owner).width*1.25;h>u&&(u=h),h=e.measureText(r.data.name).width*1.25,h>u&&(u=h),$(e,11*c,400,"normal"),h=e.measureText(`Created in ${n(r.data.createdAt)}`).width*1.25,h>u&&(u=h),h=e.measureText(`Last updated in ${n(r.data.updatedAt)}`).width*1.25,h>u&&(u=h),$(e,i.headerFontSize*c,400,"normal");const k=r.data.stars<10?String(r.data.stars):s(r.data.stars),d=r.data.forks<10?String(r.data.forks):s(r.data.forks),p=(r.data.watchers||0)<10?String(r.data.watchers||0):s(r.data.watchers||0);if(h=e.measureText(`${k} stars | ${d} forks | ${p} watchers`).width*1.25,h>u&&(u=h),r.data.languages&&r.data.languages.length>0){$(e,i.valueFontSize*c,400,"normal");let C="";const N=Te(3,r.data.languages.length);for(let m=0;m<N;m++)C+=`${r.data.languages[m]}${m<N-1?", ":""}`;h=e.measureText(C).width*1.25,h>u&&(u=h),r.data.languages.length>3&&(h=e.measureText(`& ${r.data.languages.length-3} more`).width*1.25,h>u&&(u=h))}if(r.data.totalContributors&&r.data.totalContributors>0){$(e,i.valueFontSize*c,400,"normal");const C=r.data.totalContributors,N=r.data.devseedContributors||0,m=r.data.externalContributors||0;h=e.measureText(`${C} contributors (${N} DevSeed, ${m} community)`).width*1.25,h>u&&(u=h);const v=r.data.communityRatio||0,M=Math.round(v*100),P=Ye(v);h=e.measureText(`Community Health: ${M}% (${P})`).width*1.25,h>u&&(u=h),N===1&&C>0&&(h=e.measureText("âš  Single DevSeed maintainer").width*1.25,h>u&&(u=h))}if(r.data.license&&($(e,i.valueFontSize*c,400,"normal"),h=e.measureText(`License: ${r.data.license}`).width*1.25,h>u&&(u=h)),r.data.archived&&($(e,i.valueFontSize*c,400,"italic"),h=e.measureText("ðŸ“¦ Archived").width*1.25,h>u&&(u=h)),a.clickActive&&a.clickedNode&&a.clickedNode.type==="contributor"){const C=(I=a.clickedNode.data.links_original)==null?void 0:I.find(N=>N.repo===r.id);if(C){$(e,11*c,400,"italic");const N=C.commit_count===1?"1 commit by":`${C.commit_count} commits by`;h=e.measureText(N).width*1.25,h>u&&(u=h),$(e,11.5*c,700,"normal"),h=e.measureText(a.clickedNode.data.contributor_name).width*1.25,h>u&&(u=h),$(e,11*c,400,"normal");let m="";g(C.commit_sec_min)===g(C.commit_sec_max)?m=`On ${g(C.commit_sec_max)}`:n(C.commit_sec_min)===n(C.commit_sec_max)?m=`In ${n(C.commit_sec_max)}`:m=`Between ${n(C.commit_sec_min)} / ${n(C.commit_sec_max)}`,h=e.measureText(m).width*1.25,h>u&&(u=h)}}return u=u/c+80,Math.max(u,280)}function rr(e,r,a,l,c,n,g,s){const{SF:i,REPO_CENTRAL:u,COLOR_BACKGROUND:h,COLOR_TEXT:k,COLOR_CONTRIBUTOR:d,COLOR_REPO:p,COLOR_OWNER:I,min:C}=a;let N=1.2,m,v;const M=r.x,P=r.y+(r.y<0?1:-1)*(r.max_radius?r.max_radius:r.r);let D,T;if(r.type==="contributor"?(D=r.data&&r.data.orca_received?134:80,T=280):r.type==="owner"?(D=93,T=280):r.type==="repo"?r.id===c.id?(D=80,T=280):(D=er(r,l),T=tr(e,r,l,c,i,n,g,s)):(D=93,T=280),r.type==="owner"){m=11.5,$(e,m*i,400,"normal"),r.text_lines=[],v="",r.connected_node_cloud.forEach((re,S)=>{let Y=`${re.data.name}${S<r.connected_node_cloud.length-1?", ":""}`;e.measureText(`${v}${Y}`).width*1.25>.85*T*i?(r.text_lines.push(v),v=Y):v+=Y}),v!==""&&r.text_lines.push(v),D+=r.text_lines.length*(m*N);let W=0;$(e,15*i,700,"normal"),W=e.measureText(r.data.owner).width*1.25,$(e,11.5*i,400,"normal"),r.text_lines.forEach(re=>{let S=e.measureText(re).width*1.25;S>W&&(W=S)}),W+40*i>T*i&&(T=W/i+40)}else if(r.type==="contributor"){$(e,15*i,700,"normal"),v=r.data?r.data.contributor_name:r.author_name;let W=e.measureText(v).width*1.25;W+40*i>T*i&&(T=W/i+40)}let j=r.y<0?20:-D-20;e.save(),e.translate(M*i,(P+j)*i);let x=0,b=0,Q;r.type==="contributor"?Q=d:r.type==="repo"?Q=p:r.type==="owner"&&(Q=I);const E=h||"#f7f7f7",L=(x-T/2)*i,K=b*i,ee=T*i,te=D*i;if(e.shadowBlur=3*i,e.shadowColor="#d4d4d4",e.fillStyle=E,e.fillRect(L,K,ee,te),e.shadowBlur=0,e.fillStyle=Q,e.fillRect((x-T/2-1)*i,(b-1)*i,(T+2)*i,6*i),e.textAlign="center",e.textBaseline="middle",b=18,m=12,$(e,m*i,400,"italic"),e.fillStyle=Q,v="",r.id===c.id?v=u:r.type==="contributor"?v="Contributor":r.type==="repo"?v="Repository":r.type==="owner"&&(v="Owner"),z(e,v,x*i,b*i,2.5*i),e.fillStyle=k,b+=18,r.id===c.id)m=15,$(e,m*i,700,"normal"),z(e,u,x*i,b*i,1.25*i);else if(r.type==="contributor")m=16,$(e,m*i,700,"normal"),v=r.data?r.data.contributor_name:r.author_name,z(e,v,x*i,b*i,1.25*i);else if(r.type==="owner")m=16,$(e,m*i,700,"normal"),z(e,r.data.owner,x*i,b*i,1.25*i),b+=28,m=11,e.globalAlpha=.6,$(e,m*i,400,"italic"),z(e,"Included repositories",x*i,b*i,2*i),m=11.5,b+=m*N+4,e.globalAlpha=.9,$(e,m*i,400,"normal"),r.text_lines.forEach((W,re)=>{z(e,W,x*i,b*i,1.25*i),b+=m*N});else if(r.type==="repo"&&(m=15,$(e,m*i,700,"normal"),z(e,`${r.data.owner}/`,x*i,b*i,1.25*i),z(e,r.data.name,x*i,(b+N*m)*i,1.25*i),b+=24,m=11,e.globalAlpha=.7,$(e,m*i,400,"normal"),z(e,`Created in ${n(r.data.createdAt)}`,x*i,b*i,1.25*i),b+=m*N,z(e,`Last updated in ${n(r.data.updatedAt)}`,x*i,b*i,1.25*i),b+=20,It(e,r.data,x,b,i,s),b=Nt(e,r.data,x,b,i),b=$t(e,r.data,x,b,i),b=Lt(e,r.data,x,b,i),b=xt(e,r.data,x,b,i),e.fillStyle=k,e.globalAlpha=.9,l.clickActive&&l.clickedNode&&l.clickedNode.type==="contributor")){let W=l.clickedNode.data.links_original.find(S=>S.repo===r.id);if(!W)return;let re=W.commit_count;b+=20,m=11,e.globalAlpha=.6,$(e,m*i,400,"italic"),v=re===1?"1 commit by":`${re} commits by`,z(e,v,x*i,b*i,2*i),b+=12,m=11.5,e.globalAlpha=.9,$(e,m*i,700,"normal"),z(e,l.clickedNode.data.contributor_name,x*i,b*i,1.25*i),b+=14,m=11,e.globalAlpha=.6,$(e,m*i,400,"normal"),g(W.commit_sec_min)===g(W.commit_sec_max)?v=`On ${g(W.commit_sec_max)}`:n(W.commit_sec_min)===n(W.commit_sec_max)?v=`In ${n(W.commit_sec_max)}`:v=`Between ${n(W.commit_sec_min)} / ${n(W.commit_sec_max)}`,z(e,v,x*i,b*i,1.25*i)}e.restore()}function ir(e,r,a,l,c=!1){const{SF:n,REPO_CENTRAL:g,COLOR_TEXT:s,COLOR_BACKGROUND:i,COLOR_REPO_MAIN:u,PI:h}=a;if(e.fillStyle=s,e.lineWidth=2*n,e.textAlign="center",r.id===l.id?Ue(e,n):r.type==="contributor"?Xe(e,n):r.type==="owner"?Ge(e,n):Fe(e,n),r.type==="contributor"){e.textBaseline="middle",e.save(),e.translate(r.x*n,r.y*n),e.rotate(r.contributor_angle+(r.contributor_angle>h/2?h:0)),e.translate((r.contributor_angle>h/2?-1:1)*(r.max_radius+14)*n,0),e.textAlign=r.contributor_angle>h/2?"right":"left";let k=r.data.contributor_lines.length,d=1.2,p=13;r.data.contributor_lines.forEach((I,C)=>{let N=0,m=(0-(k-1)*p*d/2+C*p*d)*n;if(r.data.orca_received){let v=e.measureText(I).width*1.25+8*n,M=N-6*n;r.contributor_angle>h/2&&(M=N+4*n-v),e.fillStyle="#CF3F0230",e.fillRect(M,-10*n+m,v,20*n),e.globalAlpha=1,e.fillStyle=s}z(e,I,N,m,1.25*n)}),e.restore()}else r.id===l.id?(e.textBaseline="middle",e.fillStyle=c?u:i,c||(e.save(),e.beginPath(),e.arc(r.x*n,r.y*n,r.r*n,0,2*h),e.clip()),r.data.owner&&z(e,`${r.data.owner}/`,r.x*n,(r.y-7.199999999999999)*n,1.25*n),z(e,r.label,r.x*n,(r.y+10.8)*n,1.25*n),c||e.restore()):r.type==="repo"?(e.textBaseline="bottom",e.strokeStyle=i,e.lineWidth=4*n,z(e,`${r.data.owner}/`,r.x*n,(r.y-r.r-3-13.200000000000001)*n,1.25*n,!0),z(e,r.label,r.x*n,(r.y-r.r-3)*n,1.25*n,!0)):(e.textBaseline="bottom",e.strokeStyle=i,e.lineWidth=4*n,z(e,`${r.label}/`,r.x*n,(r.y-r.r-3)*n,1.25*n,!0))}const ue=1500,Ie={centralRadius:35,innerRadiusFactor:.7,maxContributorWidth:55,defaultSize:1500};function Ne(e,r,a,l,c,n){e.width=a,e.height=l,e.style.width=`${c}px`,e.style.height=`${l/n}px`,r.lineJoin="round",r.lineCap="round"}function or(e,r,a,l,c,n,g,s,i,u){const{width:h,height:k,DEFAULT_SIZE:d,RADIUS_CONTRIBUTOR_NON_ORCA:p,ORCA_RING_WIDTH:I,round:C}=a,{nodes:N,remainingContributors:m}=c;l.PIXEL_RATIO=Math.max(2,window.devicePixelRatio),l.WIDTH=C(h*l.PIXEL_RATIO),l.HEIGHT=C(k*l.PIXEL_RATIO),Ne(e.canvas,r.context,l.WIDTH,l.HEIGHT,h,l.PIXEL_RATIO),Ne(e.canvas_click,r.context_click,l.WIDTH,l.HEIGHT,h,l.PIXEL_RATIO),Ne(e.canvas_hover,r.context_hover,l.WIDTH,l.HEIGHT,h,l.PIXEL_RATIO),l.SF=l.WIDTH/d;let v=p+I/2*2;l.WIDTH/2<v*l.SF&&(l.SF=l.WIDTH/(2*v)),l.nodes_delaunay=N,l.delaunay=g.Delaunay.from(l.nodes_delaunay.map(M=>[M.x,M.y])),n&&(l.delaunay_remaining=g.Delaunay.from(m.map(M=>[M.x,M.y]))),s(i,l.delaunay,l.nodes_delaunay,l.delaunay_remaining),u()}const tt=(e,r,a,l,c)=>{const n=Math.PI,g=n*2;let s=Math.round,i=Math.cos,u=Math.sin,h=Math.min,k=Math.max,d=Math.sqrt,p=r,I=Ht(),C,N,m,v,M,P,D,T,j,x,b=[],Q,E,L,K=Dt(),ee,te,W;const re=Ie.centralRadius;let S,Y,fe;const rt=Ie.innerRadiusFactor,nr=Ie.maxContributorWidth,it=a;let le=!1,me=!1;const ye=ae.background,ar=ae.grenadier,ot=ae.repoMain,nt=ae.repo,at=ae.owner,be=ae.contributor,$e=ae.link,lt=ae.text,ie=document.createElement("canvas");ie.id="canvas";const U=ie.getContext("2d"),se=document.createElement("canvas");se.id="canvas-click";const st=se.getContext("2d"),oe=document.createElement("canvas");oe.id="canvas-hover";const Le=oe.getContext("2d");e.appendChild(ie),e.appendChild(se),e.appendChild(oe),e.style.position="relative",e.style["background-color"]=ye,xe(ie),xe(oe),xe(se),ct(ie),ct(se),se.style.pointerEvents="auto",se.style.zIndex="1",oe.style.position="absolute",oe.style.top="0",oe.style.left="0",oe.style.zIndex="2",oe.style.pointerEvents="auto";function xe(o){o.style.display="block",o.style.margin="0"}function ct(o){o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.pointerEvents="none",o.style.zIndex="0",o.style.transition="opacity 200ms ease-in"}let q=ue,V=ue,we=ue,ve=ue,F,ge,_e=d3.timeParse("%Y-%m-%dT%H:%M:%SZ"),he=d3.timeParse("%s"),lr=d3.timeFormat("%b %Y"),sr=d3.timeFormat("%b %d, %Y"),cr=d3.format(",.2s");const Ce=wt(d3),Oe=vt(d3),He=Rt(d3),ut=At(d3),Me=Ct(d3);function G(o){C=JSON.parse(JSON.stringify(o[0])),N=JSON.parse(JSON.stringify(o[1])),m=JSON.parse(JSON.stringify(o[2])),ft(),o[3]&&(o[3][0].author_name!==void 0?(T=o[3],le=!0,o[4]&&(j=o[4],me=!0)):o[3][0].name!==void 0&&(j=o[3],me=!0)),mt(),je(b,E,d3,X,d,k,h),qe(b,E,d3,X,d,k),L.x=L.fx=0,L.y=L.fy=0,gt(),Q=Ve(b,E,d3,X,d,k,U,p,L,ut,S,rt),le&&Ke(T,d3,g,i,u,k,S,Y,fe,ue,He),E=Be(E,b),G.resize(),pt(),yt()}function ur(){if(q===0||V===0){console.warn("draw() called with invalid canvas size:",{WIDTH:q,HEIGHT:V,width:we,height:ve,SF:F});return}if(b.length===0){console.warn("draw() called with no nodes");return}console.log("draw() called",{WIDTH:q,HEIGHT:V,SF:F,nodesCount:b.length,canvasWidth:ie.width,canvasHeight:ie.height}),U.fillStyle=ye,U.fillRect(0,0,q,V),U.save(),U.translate(q/2,V/2),le&&(U.fillStyle=be,U.globalAlpha=.4,T.forEach(o=>{Ae(U,o.x,o.y,F,o.r)}),U.globalAlpha=1),fr(U,F),E.forEach(o=>{const _=o.target.id||o.target,A=o.source.id||o.source;_===p||A===p||o.source&&o.target&&typeof o.source.x=="number"&&typeof o.source.y=="number"&&typeof o.target.x=="number"&&typeof o.target.y=="number"&&isFinite(o.source.x)&&isFinite(o.source.y)&&isFinite(o.target.x)&&isFinite(o.target.y)&&ht(U,F,o)}),b.forEach(o=>{o.id!==p&&_t(U,F,o)}),b.forEach(o=>{o.id!==p&&ze(U,F,o)}),Q.forEach(o=>{o.id!==p&&Pe(U,o)}),U.restore()}G.resize=()=>{console.log("chart.resize() called",{width:we,height:ve,nodesCount:b.length});const o={canvas:ie,canvas_click:se,canvas_hover:oe},_={context:U,context_click:st,context_hover:Le},A={width:we,height:ve,DEFAULT_SIZE:ue,RADIUS_CONTRIBUTOR_NON_ORCA:Y,ORCA_RING_WIDTH:fe,round:s},f={WIDTH:q,HEIGHT:V,PIXEL_RATIO:ge,SF:F,nodes_delaunay:te,delaunay:ee,delaunay_remaining:W},H={nodes:b,remainingContributors:T};q=f.WIDTH,V=f.HEIGHT,ge=f.PIXEL_RATIO,F=f.SF;const y=()=>{q=f.WIDTH,V=f.HEIGHT,ge=f.PIXEL_RATIO,F=f.SF,te=f.nodes_delaunay,ee=f.delaunay,W=f.delaunay_remaining,ur()};or(o,_,A,f,H,le,d3,Qe,K,y),q=f.WIDTH,V=f.HEIGHT,ge=f.PIXEL_RATIO,F=f.SF,te=f.nodes_delaunay,ee=f.delaunay,W=f.delaunay_remaining,console.log("chart.resize() completed",{WIDTH:q,HEIGHT:V,SF:F,nodesCount:b.length})};function ft(){if(!N||!m||!C){console.error("applyFilters(): Original data not initialized");return}v=JSON.parse(JSON.stringify(N)),Wt(I)&&(v=v.filter(f=>{if(f.repo===p)return!0;const H=f.repo.substring(0,f.repo.indexOf("/"));return Pt(I,H)}));const o=new Set(v.map(f=>f.repo));M=m.filter(f=>o.has(f.repo)).map(f=>JSON.parse(JSON.stringify(f)));const _=new Set(M.map(f=>f.author_name));P=C.filter(f=>_.has(f.author_name)).map(f=>JSON.parse(JSON.stringify(f)));const A=new Set(P.map(f=>f.author_name));M=M.filter(f=>A.has(f.author_name)),D=P,x=v,E=M,localStorage.getItem("debug-orca")==="true"&&(console.debug("=== APPLY FILTERS ==="),console.debug(`Filters applied: ${I.organizations.join(", ")||"none"}`),console.debug(`Data before: ${C.length} contributors, ${N.length} repos, ${m.length} links`),console.debug(`Data after: ${P.length} contributors, ${v.length} repos, ${M.length} links`),console.debug("Visible repos:",v.map(f=>f.repo)),console.debug("Visible contributors:",P.map(f=>f.author_name)))}function mt(){D.forEach(t=>{t.contributor_name=t.author_name,me?t.orca_received=!!j.find(w=>w.name===t.author_name):t.orca_received=!1,t.color=be,Xe(U),[t.contributor_lines,t.contributor_max_width]=Tt(U,t.contributor_name,nr),delete t.contributor_name_top}),x.forEach(t=>{t.forks=+t.repo_forks,t.stars=+t.repo_stars,t.watchers=+t.repo_watchers||0,t.openIssues=+t.repo_open_issues||0,t.license=t.repo_license||null,t.topics=t.repo_topics?t.repo_topics.split(",").filter(w=>w!==""):[],t.hasDiscussions=t.repo_has_discussions==="true"||t.repo_has_discussions===!0,t.archived=t.repo_archived==="true"||t.repo_archived===!0,t.totalContributors=+t.repo_total_contributors||0,t.devseedContributors=+t.repo_devseed_contributors||0,t.externalContributors=+t.repo_external_contributors||0,t.communityRatio=+t.repo_community_ratio||0,We(t.createdAt)?(t.createdAt=he(t.createdAt),t.updatedAt=he(t.repo_updatedAt)):(t.createdAt=_e(t.repo_createdAt),t.updatedAt=_e(t.repo_updatedAt)),t.owner=t.repo.substring(0,t.repo.indexOf("/")),t.name=t.repo.substring(t.repo.indexOf("/")+1),t.languages=t.repo_languages.split(","),t.languages=t.languages.filter(w=>w!==""&&w!==" "),t.color=nt,delete t.repo_forks,delete t.repo_stars,delete t.repo_watchers,delete t.repo_open_issues,delete t.repo_license,delete t.repo_topics,delete t.repo_has_discussions,delete t.repo_archived,delete t.repo_total_contributors,delete t.repo_devseed_contributors,delete t.repo_external_contributors,delete t.repo_community_ratio,delete t.repo_createdAt,delete t.repo_updatedAt}),E.forEach(t=>{t.contributor_name=t.author_name,t.commit_count=+t.commit_count,We(t.commit_sec_min)?(t.commit_sec_min=he(t.commit_sec_min),t.commit_sec_max=he(t.commit_sec_max)):(t.commit_sec_min=_e(t.commit_sec_min),t.commit_sec_max=_e(t.commit_sec_max)),t.owner=t.repo.substring(0,t.repo.indexOf("/")),t.name=t.repo.substring(t.repo.indexOf("/")+1),t.source=t.contributor_name,t.target=t.repo,delete t.author_name}),le&&T.forEach(t=>{t.commit_count=+t.commit_count,We(t.commit_sec_min)?(t.commit_sec_min=he(t.commit_sec_min),t.commit_sec_max=he(t.commit_sec_max)):(t.commit_sec_min=_e(t.commit_sec_min),t.commit_sec_max=_e(t.commit_sec_max)),t.type="contributor",t.remaining_contributor=!0,t.color=be}),D.forEach((t,w)=>{b.push({id:t.contributor_name,type:"contributor",label:t.contributor_name,data:t})}),x.forEach((t,w)=>{b.push({id:t.repo,type:"repo",label:t.name,data:t})}),D.forEach(t=>{t.links_original=E.filter(w=>X(w.source)===t.contributor_name),t.repos=t.links_original.map(w=>x.find(O=>O.repo===w.repo))}),x.forEach(t=>{t.links_original=E.filter(w=>X(w.target)===t.repo),t.contributors=t.links_original.map(w=>D.find(O=>O.contributor_name===w.contributor_name)).filter(w=>w!==void 0)}),x.forEach(t=>{t.orca_impacted=!1,t.links_original.forEach(w=>{D.find(O=>O.contributor_name===w.contributor_name&&O.orca_received===!0)&&(t.orca_impacted=!0)})}),L=b.find(t=>t.type==="repo"&&t.id===p);let o=b.filter(t=>t.type==="repo"&&b.filter(w=>w.id!==t.id&&w.type==="repo"&&w.data.owner===t.data.owner).length>1).map(t=>t.data);o=d3.group(o,t=>t.owner),o=Array.from(o,([t,w])=>({owner:t,repos:w.map(O=>O.name),color:at,stars:d3.sum(w,O=>O.stars),forks:d3.sum(w,O=>O.forks)})),o.sort((t,w)=>t.owner.toLowerCase()<w.owner.toLowerCase()?-1:t.owner.toLowerCase()>w.owner.toLowerCase()?1:0);const _=o.length;o=o.filter(t=>b.filter(O=>O.type==="repo"&&O.data.owner===t.owner).length===0?(debugWarn(`Filtering out owner with no repos: ${t.owner}`),!1):!0),localStorage.getItem("debug-orca")==="true"&&_!==o.length&&console.debug(`Removed ${_-o.length} owners with no repos`),localStorage.getItem("debug-orca")==="true"&&(console.log("Owners:",o),console.log("Contributors:",D)),b.filter(t=>t.type==="repo").forEach(t=>{t.data.multi_repo_owner=!!o.find(w=>w.owner===t.data.owner)}),o.forEach((t,w)=>{b.push({id:t.owner,type:"owner",label:t.owner,data:t})});let A=[],f=[];E.forEach(t=>{t.repo!==p&&o.find(w=>w.owner===t.owner)&&(A.push({source:t.owner,target:t.repo,owner:t.owner,commit_count:t.commit_count,commit_sec_min:t.commit_sec_min,commit_sec_max:t.commit_sec_max}),f.push({source:t.contributor_name,target:t.owner,owner:t.owner,commit_count:t.commit_count,commit_sec_min:t.commit_sec_min,commit_sec_max:t.commit_sec_max}),t.to_remove=!0)}),E=E.filter(t=>t.to_remove!==!0),f=d3.group(f,t=>t.source+"~"+t.target),f=Array.from(f,([t,w])=>{let[O,J]=t.split("~");return{source:O,target:J,owner:w[0].owner,commit_count:d3.sum(w,B=>B.commit_count),commit_sec_min:d3.min(w,B=>B.commit_sec_min),commit_sec_max:d3.max(w,B=>B.commit_sec_max)}}),A=d3.group(A,t=>t.source+"~"+t.target),A=Array.from(A,([t,w])=>{let[O,J]=t.split("~");return{source:O,target:J,owner:w[0].owner,commit_count:d3.sum(w,B=>B.commit_count),commit_sec_min:d3.min(w,B=>B.commit_sec_min),commit_sec_max:d3.max(w,B=>B.commit_sec_max)}}),E=[...E,...A,...f],E=E.filter(t=>!t.source||typeof t.source!="string"||t.source.trim()===""?(localStorage.getItem("debug-orca")==="true"&&console.warn(`Filtered link with empty source: â†’ "${t.target}"`),!1):!t.target||typeof t.target!="string"||t.target.trim()===""?(localStorage.getItem("debug-orca")==="true"&&console.warn(`Filtered link with empty target: "${t.source}" â†’`),!1):!0);const H=new Set(b.map(t=>t.id));E=E.filter(t=>{const w=H.has(t.source),O=H.has(t.target);return!w||!O?(localStorage.getItem("debug-orca")==="true"&&console.warn(`Filtered invalid link: "${t.source}" â†’ "${t.target}"`,{sourceNodeExists:w,targetNodeExists:O}),!1):!0}),L.data.owner&&L.data.owner.trim()!==""&&E.push({source:L.data.owner,target:L.id,owner:L.data.owner,commit_count:d3.sum(E.filter(t=>X(t.target)===L.id),t=>t.commit_count),commit_sec_min:d3.min(E.filter(t=>X(t.target)===L.id),t=>t.commit_sec_min),commit_sec_max:d3.max(E.filter(t=>X(t.target)===L.id),t=>t.commit_sec_max)}),localStorage.getItem("debug-orca")==="true"&&console.log("Links:",E),o.forEach(t=>{let w=E.filter(O=>X(O.target)===t.owner);t.single_contributor=w.length===1,t.repos=b.filter(O=>O.type==="repo"&&O.data.owner===t.owner).map(O=>O.data)});const y=x.map(t=>t.stars);y.length>0?Ce.domain(d3.extent(y)):Ce.domain([0,10]);const R=E.filter(t=>X(t.target)===L.id);R.length>0?Oe.domain(d3.extent(R,t=>t.commit_count)):Oe.domain([1,10]),E.length>0?Me.domain([1,10,d3.max(E,t=>t.commit_count)]):Me.domain([1,10,60]),He.domain([0,Oe.domain()[0]]),b.forEach((t,w)=>{if(t.index=w,t.data.index=w,t.degree=E.filter(O=>X(O.source)===t.id||X(O.target)===t.id).length,t.x=0,t.y=0,t.type==="contributor"){let O=E.find(J=>X(J.source)===t.id&&X(J.target)===L.id);t.data.link_central=O,t.r=Oe(t.data.link_central.commit_count)}else t.type,t.r=Ce(t.data.stars);t.color=t.data.color}),b.sort((t,w)=>t.type===w.type?t.data.link_central&&w.data.link_central?t.data.link_central.commit_sec_min<w.data.link_central.commit_sec_min?-1:t.data.link_central.commit_sec_min>w.data.link_central.commit_sec_min?1:0:0:t.type<w.type?-1:t.type>w.type?1:0),L.r=re,L.padding=re,L.special_type="central",L.color=ot}function gt(){const o=b.filter(R=>R.type==="contributor");o.forEach(R=>{(!R.max_radius||!isFinite(R.max_radius)||R.max_radius<=0)&&(R.max_radius=R.r||20),R.connected_single_repo||(R.connected_single_repo=[])});let _=o.reduce((R,t)=>R+t.max_radius*2,0);_+=D.length*it,S=_/g;const A=Math.max(200,o.length*15);let f=!1;(!isFinite(S)||S<A)&&(console.warn(`RADIUS_CONTRIBUTOR too small (${S}), using minimum ${A}`),S=A,f=!0),Y=S*(me?1.3:1),fe=(S*2.3/2-S)*2;const H=g/o.length;console.log(`positionContributorNodes: ${o.length} contributors, sum_radius=${_}, RADIUS_CONTRIBUTOR=${S}, useEvenSpacing=${f}`);let y=0;o.forEach((R,t)=>{R.connected_single_repo&&R.connected_single_repo.length>0&&R.connected_single_repo.forEach(B=>{B.x-=R.x,B.y-=R.y}),t<3&&console.log(`Contributor ${t} "${R.id}": max_radius=${R.max_radius}, r=${R.r}, central_repo=(${L.fx}, ${L.fy})`);let w=R.max_radius*2+it,O;f?O=H/2:O=w/S/2;let J=R.data.orca_received?S:Y;R.x=L.fx+J*i(y+O-n/2),R.y=L.fy+J*u(y+O-n/2),R.contributor_angle=y+O-n/2,y+=f?H:O*2,R.fx=R.x,R.fy=R.y,R.connected_single_repo&&R.connected_single_repo.length>0&&R.connected_single_repo.forEach(B=>{B.x+=R.x,B.y+=R.y,B.fx=B.x,B.fy=B.y})})}function fr(o,_){o.fillStyle=o.strokeStyle=ar;let A=fe,f=4;o.lineWidth=1.5*_,me&&(o.beginPath(),o.moveTo(0+(S+A/2-f)*_,0),o.arc(0,0,(S+A/2-f)*_,0,g),o.moveTo(0+(S-A/2)*_,0),o.arc(0,0,(S-A/2)*_,0,g,!0),o.globalAlpha=.06,o.fill(),o.globalAlpha=.2),o.beginPath(),o.moveTo(0+(Y+A/2)*_,0),o.arc(0,0,(Y+A/2)*_,0,g),o.moveTo(0+(Y-A/2+f)*_,0),o.arc(0,0,(Y-A/2+f)*_,0,g,!0),o.globalAlpha=me?.03:.05,o.fill(),o.globalAlpha=.1,me&&(o.textAlign="center",$(o,16*_,700,"italic"),o.globalAlpha=.5,o.textBaseline="bottom",Je(o,"contributors supported through ORCA",g*.9,(S-(A/2-f-2))*_,"up",1.5*_),o.textBaseline="top",Je(o,"other top contributors",g*.9,(Y+(A/2-f-2))*_,"up",1.5*_)),o.globalAlpha=1}function ze(o,_,A){qt(o,_,A,{REPO_CENTRAL:p,COLOR_BACKGROUND:ye,max:k},K)}function _t(o,_,A){Vt(o,_,A,K,be,d3,L)}function mr(o,_){Kt(o,_,F,L)}function ht(o,_,A){Qt(o,_,A,{COLOR_LINK:$e},K,_r,gr,Me)}function gr(o,_=2,A=!0){o.r=d(ne(o.target.x-o.source.x)+ne(o.target.y-o.source.y))*_;let f=H(o.r,{x:o.source.x,y:o.source.y},{x:o.target.x,y:o.target.y});o.sign=A,o.center=o.sign?f.c2:f.c1;function H(y,R,t){let w={x:.5*(R.x+t.x),y:.5*(R.y+t.y)},O=-(t.y-R.y),J=t.x-R.x,B=d(ne(O)+ne(J));O/=B,J/=B;let pe=d(ne(w.x-R.x)+ne(w.y-R.y))/y;if(pe<-1||pe>1)return null;let Re=d(1-ne(pe)),de=y*Re,pr={x:w.x+O*de,y:w.y+J*de},dr={x:w.x-O*de,y:w.y-J*de};return{c1:pr,c2:dr}}}function _r(o,_){const A=d3.scaleLinear().domain([300,800]).range([.5,.2]).clamp(!0);let f;K.hoverActive?f=_.target.special_type?.3:.7:f=_.target.special_type?.15:A(E.length),H(_,f);function H(y,R){var J,B,De,pe;let t,w,O;if(t=d3.rgb(y.source.color),w="rgba("+t.r+","+t.g+","+t.b+","+R+")",t=d3.rgb(y.target.color),O="rgba("+t.r+","+t.g+","+t.b+","+R+")",y.source&&y.target&&typeof y.source.x=="number"&&typeof y.source.y=="number"&&typeof y.target.x=="number"&&typeof y.target.y=="number"&&isFinite(y.source.x)&&isFinite(y.source.y)&&isFinite(y.target.x)&&isFinite(y.target.y))try{y.gradient=o.createLinearGradient(y.source.x*F,y.source.y*F,y.target.x*F,y.target.y*F);let Re=d(ne(y.target.x-y.source.x)+ne(y.target.y-y.source.y)),de=y.source.r/Re;y.gradient.addColorStop(de,w),y.gradient.addColorStop(1,O)}catch(Re){localStorage.getItem("debug-orca")==="true"&&console.warn("Gradient creation error:",Re,{link:y,sf:F}),y.gradient=$e}else localStorage.getItem("debug-orca")==="true"&&console.warn("Invalid coordinates for gradient",{sourceX:(J=y.source)==null?void 0:J.x,sourceY:(B=y.source)==null?void 0:B.y,targetX:(De=y.target)==null?void 0:De.x,targetY:(pe=y.target)==null?void 0:pe.y}),y.gradient=$e}}function pt(){const o={PIXEL_RATIO:ge,WIDTH:q,HEIGHT:V,SF:F,RADIUS_CONTRIBUTOR_NON_ORCA:Y,ORCA_RING_WIDTH:fe,sqrt:d},_={get delaunay(){return ee},set delaunay(A){ee=A},get nodesDelaunay(){return te},set nodesDelaunay(A){te=A},get delaunayRemaining(){return W},set delaunayRemaining(A){W=A}};Xt(d3,"#canvas-hover",o,_,K,p,ie,Le,le,T,St,Ze,dt)}function dt(o,_,A=!0){o.save(),o.clearRect(0,0,q,V),o.translate(q/2,V/2),_.neighbor_links===void 0&&(_.neighbor_links=E.filter(f=>{const H=f.target.id||f.target,y=f.source.id||f.source;return H===p||y===p?!1:f.source.id===_.id||f.target.id===_.id})),_.neighbors===void 0&&(_.neighbors=b.filter(f=>f.id===p?!1:E.find(H=>{const y=H.target.id||H.target,R=H.source.id||H.source;return y===p||R===p?!1:H.source.id===_.id&&H.target.id===f.id||H.target.id===_.id&&H.source.id===f.id})),(_.type==="contributor"||_.type==="repo"&&_!==L)&&(_.neighbors.forEach(f=>{f&&f.type==="owner"&&_.data&&_.data.links_original&&_.data.links_original.forEach(H=>{if(H.owner===f.id){let y,R;if(_.type==="contributor"){if(y=b.find(t=>t.id===H.repo),!y)return;R=E.find(t=>t.source.id===f.id&&t.target.id===y.id)}else if(_.type==="repo"){if(y=b.find(t=>t.id===H.contributor_name),!y)return;R=E.find(t=>t.source.id===y.id&&t.target.id===f.id)}y&&(_.neighbors.push(y),R&&_.neighbor_links.push(R))}})}),_.neighbor_links=_.neighbor_links.filter(f=>!(f.target.id===L.id&&f.source.id===L.data.owner)))),_.neighbor_links&&_.neighbor_links.forEach(f=>{f&&f.source&&f.target&&ht(o,F,f)}),_.neighbors&&(_.neighbors.forEach(f=>{f&&_t(o,F,f)}),_.neighbors.forEach(f=>{f&&ze(o,F,f)}),_.neighbors.forEach(f=>{f&&f.node_central&&Pe(o,f)})),ze(o,F,_),mr(o,_),_.node_central&&_.type==="contributor"&&Pe(o,_),A&&hr(o,_),o.restore()}function yt(){const o={PIXEL_RATIO:ge,WIDTH:q,HEIGHT:V,SF:F,RADIUS_CONTRIBUTOR_NON_ORCA:Y,ORCA_RING_WIDTH:fe,sqrt:d},_={get delaunay(){return ee},set delaunay(A){ee=A},get nodesDelaunay(){return te},set nodesDelaunay(A){te=A},get delaunayRemaining(){return W},set delaunayRemaining(A){W=A}};Jt(d3,"#canvas-hover",o,_,K,p,ie,st,Le,b,le,T,Bt,Ft,Ze,Qe,dt)}function hr(o,_){rr(o,_,{SF:F,REPO_CENTRAL:p,COLOR_BACKGROUND:ye,COLOR_TEXT:lt,COLOR_CONTRIBUTOR:be,COLOR_REPO:nt,COLOR_OWNER:at,min:h},K,L,lr,sr,cr)}function Pe(o,_,A=!1){ir(o,_,{SF:F,REPO_CENTRAL:p,COLOR_TEXT:lt,COLOR_BACKGROUND:ye,COLOR_REPO_MAIN:ot,PI:n},L,A)}function ne(o){return o*o}function We(o){return/^\d+$/.test(o)}return G.width=function(o){return arguments.length?(we=o,G):we},G.height=function(o){return arguments.length?(ve=o,G):ve},G.repository=function(o){return arguments.length?(p=o,G):p},G.rebuild=function(){b=[],E=[],Q=[],Ut(K),Gt(K),te=[],ee=null,W=null,ft(),mt(),L.x=L.fx=0,L.y=L.fy=0,je(b,E,d3,X,d,k,h),qe(b,E,d3,X,d,k),gt(),Q=Ve(b,E,d3,X,d,k,U,p,L,ut,S,rt),le&&Ke(T,d3,g,i,u,k,S,Y,fe,ue,He),E=Be(E,b);const o=b.filter(_=>_.x===0&&_.y===0&&_.id!==p);if(o.length>0){const _=b.filter(y=>y.type==="contributor").length,A=b.filter(y=>y.type==="repo").length;let f=0,H=0;o.forEach(y=>{if(y.type==="contributor"){const R=f/Math.max(1,_)*Math.PI*2,t=250;y.x=Math.cos(R)*t,y.y=Math.sin(R)*t,y.r||(y.r=6),f++}else if(y.type==="repo"){const R=H/Math.max(1,A)*Math.PI*2,t=150+Math.random()*50;y.x=Math.cos(R)*t,y.y=Math.sin(R)*t,y.r||(y.r=8),H++}else if(y.type==="owner"){const R=H/5*Math.PI*2,t=50;y.x=Math.cos(R)*t,y.y=Math.sin(R)*t,y.r||(y.r=15)}}),localStorage.getItem("debug-orca")==="true"&&console.debug(`Positioned ${o.length} unpositioned nodes in rings by type`)}return E.forEach(_=>{_.source&&_.target&&((typeof _.source.x!="number"||typeof _.source.y!="number"||!isFinite(_.source.x)||!isFinite(_.source.y))&&(_.source.x=0,_.source.y=0),(typeof _.target.x!="number"||typeof _.target.y!="number"||!isFinite(_.target.x)||!isFinite(_.target.y))&&(_.target.x=0,_.target.y=0))}),pt(),yt(),G.resize(),G},G.setFilter=function(o,_){return _?Mt(I,o):zt(I,o),G.rebuild(),G},G.getActiveFilters=function(){return{...I}},G.getNodes=function(){return b},G.getLinks=function(){return E},G.getDebugState=function(){const o=E.filter(f=>f.source&&f.target&&typeof f.source=="object"&&typeof f.target=="object"),_=o.filter(f=>{const H=f.target.id||f.target,y=f.source.id||f.source;return H!==p&&y!==p}),A=_.filter(f=>f.source&&f.target&&typeof f.source.x=="number"&&typeof f.source.y=="number"&&typeof f.target.x=="number"&&typeof f.target.y=="number"&&isFinite(f.source.x)&&isFinite(f.source.y)&&isFinite(f.target.x)&&isFinite(f.target.y));return{nodesCount:b.length,linksCount:E.length,nodeTypes:b.reduce((f,H)=>(f[H.type]=(f[H.type]||0)+1,f),{}),validLinks:o.length,linksToBeDrawn:_.length,linksWithValidCoordinates:A.length,activeFilters:{...I}}},G};return typeof window<"u"&&(window.createORCAVisual=tt),ke.createORCAVisual=tt,Object.defineProperty(ke,Symbol.toStringTag,{value:"Module"}),ke}({});
